sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
#  filter(SOURCE_TYPE == "web" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "web" & kword == "bosch") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "twitter" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "instagram" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" & kword == "bosch") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillips %>%
group_by(type) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
select(-Tot) %>%
arrange(desc(N)) %>%
filter(type != "comment") %>%
rename(Medij = type,
'Broj objava' = N) %>%
kbl(caption = "Broj objava po medijima") %>%
kable_paper(bootstrap_options = "striped",full_width = F, position = "right")
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" & kword == "braun") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "instagram" & kword == "braun") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "instagram" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "forum" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
# filter(SOURCE_TYPE == "forum" & kword == "phillips") %>%
unnest_tokens(word, MENTION_SNIPPET) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
# filter(SOURCE_TYPE == "forum" & kword == "phillips") %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "forum" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "forum" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "web" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "twitter" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "instagram" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
phillipstxt %>%
mutate(kword = case_when(grepl("phill", MENTION_SNIPPET, ignore.case = TRUE) ~ "phillips",
grepl("bosch", MENTION_SNIPPET, ignore.case = TRUE) ~ "bosch",
grepl("braun", MENTION_SNIPPET, ignore.case = TRUE) ~ "braun",
grepl("dyson", MENTION_SNIPPET, ignore.case = TRUE) ~ "dyson")) %>%
filter(SOURCE_TYPE == "facebook" ) %>%
unnest_tokens(word, TITLE) %>%
anti_join(stop_corpus, by = "word") %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment, sort = TRUE) -> sg
sg %>%
group_by(sentiment) %>%
top_n(20) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRALNO",
sentiment == 1 ~ "NEGATIVNO",
sentiment == 2 ~ "POZITIVNO")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Doprinos sentimentu") +
labs( x = "Rijec", y = "Broj rijeci") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist()-> gg_doprinos_sentimentu
gg_doprinos_sentimentu
