mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views,channels) %>%
group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot() +
facet_wrap(~Category,scales = "free")
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot() +
facet_wrap(~Category,scales = "free")
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot() +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot() +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot() +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot(outlier.colour = NA) +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
geom_boxplot(outlier.colour = NA) +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views) %>%
group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format(accuracy = 0.01,
decimal.mark = ','))
descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views) %>%
#  group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre)
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_grid(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
txt <- c("Pretplatnici", "Video", "Pregledi")
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free", labeler = txt) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free", labeler = label_bquote(txt)) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views)
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views)  %>%
mutate(Ranges = recode_factor(.$Category,
"videos" = "Video",
"subscribers" = "Pretplatnici",
"views" = "Pregledi")) %>%
#  group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup()
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views)
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views)  %>%
mutate(Category = recode_factor(.$Category,
"videos" = "Video",
"subscribers" = "Pretplatnici",
"views" = "Pregledi")) %>%
#  group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." ))
dscGG
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bube", "Glodavci", "Sisavci","Dinosauri")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Channel size") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
options(digits = 2, scipen = 999)
genreBYrange <- ranges %>%
select(-X, -name,- link,-lastvideo) %>%
gather(., Category, Number, subscribers, videos, views) %>%
group_by(Category) %>%
mutate(TotBYcategory = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges) %>%
mutate(TotBYCategoryANDRange = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges,genre,TotBYCategoryANDRange,TotBYcategory) %>%
summarise(TotBYCategoryANDRangeANDGenre = sum(Number, na.rm = TRUE)) %>%
mutate(`Share %` = (TotBYCategoryANDRangeANDGenre / TotBYCategoryANDRange)*100) %>%
na.omit() %>%
filter(genre != "")
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bube", "Glodavci", "Sisavci","Dinosauri")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Channel size") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bube", "Glodavci", "Sisavci","Dinosauri")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Channel size") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
ranges %>%
select(-X, -name,- link,-lastvideo)
ranges
<br>
U ovom ću postu dati osnovni pregled hrvatskog YouTube-a koji uključuje: **1)** deskriptivni prikaz najvažnijih karakteristika domaćih YouTube kanala, **2)** kanale prema veličini i kategorijama te **3)** analizu stratifikacije i hijerarhizacije hrvatskog dijela YouTube platforme. Analiza je inspirana nizom ([I](https://journals.sagepub.com/doi/10.1177/1354856517736979),[II](https://scholarspace.manoa.hawaii.edu/handle/10125/59701),[III](https://eprints.qut.edu.au/202962/1/View_of_Mapping_YouTube_First_Monday.pdf)) "svježe" objavljenih radova koji analiziraju YouTube platformu na osnovi različitih podataka i iz različitog kuta. Za ovu analizu su korišteni podatci o oko (~)2 tisuće (k) hrvatskih YouTube kanala preuzeti sa [SOCIAL BLADE](https://socialblade.com/) i [ChannelCrawler](https://channelcrawler.com/). Podatci i `code` su OpenSource-ani u [repozitoriju](https://github.com/lusiki/Learning-Social-Media-Analytics) kolegija [Learning Social Media Analytics](https://lusiki.github.io/Learning-Social-Media-Analytics/) koji je u pripremi za 2021/22 godinu na [FHS](https://www.hrstud.unizg.hr/).
knitr::opts_chunk$set(echo = TRUE)
yt <- read.csv2("../data/YouTube/YT.csv")
yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "1-10k",
"(1e+04,1e+05]" = "10-100k",
"(1e+05,2e+05]" = "100-200k",
"(2e+05,3e+05]" = "200-300k",
"(3e+05,4e+05]" = "300-400k",
"(4e+05,5e+05]" = "400-500k",
"(5e+05,1e+06]" = "500-600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE))
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(cowplot)
library(magick)
library(png)
library(RCurl)
library(patchwork)
library(grid)
library(ggpubr)
library(scales)
library(kableExtra)
yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "1-10k",
"(1e+04,1e+05]" = "10-100k",
"(1e+05,2e+05]" = "100-200k",
"(2e+05,3e+05]" = "200-300k",
"(3e+05,4e+05]" = "300-400k",
"(4e+05,5e+05]" = "400-500k",
"(5e+05,1e+06]" = "500-600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE))
View(yt)
options(scipen = 999)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "1-10k",
"(1e+04,1e+05]" = "10-100k",
"(1e+05,2e+05]" = "100-200k",
"(2e+05,3e+05]" = "200-300k",
"(3e+05,4e+05]" = "300-400k",
"(4e+05,5e+05]" = "400-500k",
"(5e+05,1e+06]" = "500-600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number, -Ranges)
gghist <- hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Broj") +
xlab("Broj pretplatnika") +
ggtitle("Hrvatski YouTube kanali po veličini")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text.x=element_text(angle=45,hjust=1))
gghist
