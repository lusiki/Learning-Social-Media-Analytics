filter(N > 2) %>%
filter(domain != "forum.hr")-> landscapeFreqBrand
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
group_by(domain,kword) %>%
summarise(N =  sum(engagement, na.rm = TRUE)) %>%
arrange(desc(N))  %>%
filter(!is.na(domain)) %>%
filter(N > 20) %>%
filter(domain != "forum.hr")-> landscapeFreqBrand
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = fword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (engagement)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8))-> g6
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = fword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (engagement)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8))-> g6
ggplotly(g6)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (engagement)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8))-> g6
ggplotly(g6)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (engagement)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip()-> g6
ggplotly(g6)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
group_by(domain,kword) %>%
summarise(N =  sum(prValue, na.rm = TRUE)) %>%
arrange(desc(N))  %>%
filter(!is.na(domain)) %>%
filter(N > 20) %>%
filter(domain != "forum.hr")-> landscapeFreqBrand
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g7
ggplotly(g7)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g7
ggplotly(g7)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
group_by(domain,kword) %>%
summarise(N =  sum(prValue, na.rm = TRUE)) %>%
arrange(desc(N))  %>%
filter(!is.na(domain)) %>%
filter(N > 20) %>%
filter(domain != "forum.hr")-> landscapeFreqBrand
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g7
ggplotly(g7)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip()
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (prValue)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g7
ggplotly(g7)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (virality)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) -> g8
qqplotly(g8)
library(plotly)
qqplotly(g8)
ggplotly(g8)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (virality)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip()-> g8
ggplotly(g8)
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("Izvor") +
ggtitle("Pregled po domenama (virality)") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip()-> g8
ggplotly(g8)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
filter(type == "youtube") %>%
group_by(kword) %>%
summarise(View =  sum(view, na.rm = TRUE),
Comment =  sum(comment, na.rm = TRUE),
Engagement =  sum(engagement, na.rm = TRUE),
Like =  sum(like, na.rm = TRUE),
#  Virality =  sum(virality, na.rm = TRUE),
prValue =  sum(prValue, na.rm = TRUE)) %>%
gather(Var, Val,-kword) %>%
ggplot(., aes(x = kword, y = Val)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~ Var, scales = "free") +
ylab("Broj objava") +
xlab("") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) -> g8
ggplotly(g8)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
filter(type == "youtube") %>%
group_by(kword) %>%
summarise(View =  sum(view, na.rm = TRUE),
Comment =  sum(comment, na.rm = TRUE),
Engagement =  sum(engagement, na.rm = TRUE),
Like =  sum(like, na.rm = TRUE),
#  Virality =  sum(virality, na.rm = TRUE),
prValue =  sum(prValue, na.rm = TRUE)) %>%
gather(Var, Val,-kword) %>%
ggplot(., aes(x = kword, y = Val, fill = Var)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~ Var, scales = "free") +
ylab("Broj objava") +
xlab("") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) -> g8
ggplotly(g8)
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100)
brandTxT <- phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson"))
brandTitle <- phillips %>%
mutate(kword = case_when(grepl("phill", title, ignore.case = TRUE) ~ "phillips",
grepl("bosch", title, ignore.case = TRUE) ~ "bosch",
grepl("braun", title, ignore.case = TRUE) ~ "braun",
grepl("dyson", title, ignore.case = TRUE) ~ "dyson"))
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100)
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
mutate(kword=replace(kword, kword==is.na, "not in text"))
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
mutate(kword=replace_na(kword, 0))
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
mutate(kword=replace_na(kword, "no brand"))  %>%
select(-Tot) %>%
arrange(desc(N)) %>%
rename (Brand = kword,
'Broj objava' = N) %>%
kbl() %>%
kable_paper(bootstrap_options = "striped",full_width = F,position = "float_left") %>%
footnote(general = "*Broj objava u tekstu:")
brandTitle %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
mutate(kword=replace_na(kword, "no brand"))  %>%
select(-Tot) %>%
arrange(desc(N)) %>%
rename (Brand = kword,
'Broj objava' = N) %>%
kbl() %>%
kable_paper(bootstrap_options = "striped",full_width = F, position = "float_right") %>%
footnote(general = "*Broj objava u naslovu:")
brandTxT %>%
group_by(kword) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Tot = sum(N),
'Udio %' = (N / Tot)*100) %>%
mutate(kword=replace_na(kword, "no brand"))  %>%
select(-Tot) %>%
arrange(desc(N)) %>%
rename (Brand = kword,
'Broj objava' = N) %>%
kbl(caption = "") %>%
kable_paper(bootstrap_options = "striped",full_width = F,position = "float_left") %>%
footnote(general = "*Broj objava u tekstu:")
knitr::opts_chunk$set(echo = TRUE, cache = F)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
group_by(domain,kword) %>%
summarise(N = n()) %>%
arrange(desc(N))  %>%
filter(!is.na(domain)) %>%
filter(N > 2) %>%
filter(domain != "forum.hr")-> landscapeFreqBrand
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("") +
ggtitle("Pregled po domenama") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g4
print(ggplotly(g4))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("") +
ggtitle("Pregled po domenama")
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("") +
ggtitle("Pregled po domenama") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana")
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("") +
ggtitle("Pregled po domenama") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(domain,N), y = N, fill = kword)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~kword, scales = "free") +
ylab("Broj objava") +
xlab("") +
ggtitle("Pregled po domenama") +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=8)) +
coord_flip() -> g4
ggplotly(g4)
phillips %>%
mutate(kword = case_when(grepl("phill", mention, ignore.case = TRUE) ~ "phillips",
grepl("bosch", mention, ignore.case = TRUE) ~ "bosch",
grepl("braun", mention, ignore.case = TRUE) ~ "braun",
grepl("dyson", mention, ignore.case = TRUE) ~ "dyson")) %>%
filter(type == "web" & kword == "phillips") %>%
unnest_tokens(word, mention) %>%
anti_join(stop_corpus, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) %>%
filter(!is.na(word)) -> rijeci_clean
ggplotly(g1)
brandTxT %>%
mutate(time = as_datetime(time),
time = as.Date(time, format="%Y-%m-%d"),
week = floor_date(time, "week")) %>%
group_by(week) %>%
count(kword) %>%
filter(!is.na(kword)) %>%
mutate(gn = sum(n)) %>%
ggplot(., aes(week, n / gn, fill=kword)) +
geom_bar(stat = "identity") +
geom_line(size = 0.9) +
ggtitle("") +
ylab("Ukupnih objava") +
xlab("") +
facet_wrap(~ kword) +
scale_fill_manual(values = cbp1) +
scale_colour_manual(values=cbp1) +
scale_y_continuous(labels = scales::percent_format()) +
scale_x_date(labels = date_format("%d-%m")) +
theme_economist(base_family="Verdana") +
theme(
legend.position="none",
panel.spacing = unit(0, "lines"),
strip.text.x = element_text(size = 5),
plot.title = element_text(size=13)) -> g1
ggplotly(g1)
