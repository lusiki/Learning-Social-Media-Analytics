ggtitle("Industrija") +
xlab("Industrija") +
ylab("Frequency") +
scale_x_continuous(breaks = seq(from = min(dta$INDUSTRIJA), to =  max(dta$INDUSTRIJA), by = 1)) +
coord_flip()
industry_list %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
gg1 <- dta %>%
group_by(INDUSTRIJA,SENTIMENT) %>%
summarise(BrojObjava = n()) %>%
#  arrange(desc(BrojObjava)) %>%
left_join(industry_list, by = c("INDUSTRIJA" = "id")) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
ggplot(gg1, aes(x = factor(SENTIMENT), y = BrojObjava, fill = factor(SENTIMENT))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Sentiment",
y = "Broj Objava",
title = "Sentimenti po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "Sentiment")
gg1 <- dta %>%
group_by(INDUSTRIJA,SENTIMENT) %>%
summarise(BrojObjava = n()) %>%
#  arrange(desc(BrojObjava)) %>%
left_join(industry_list, by = c("INDUSTRIJA" = "id")) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
ggplot(gg1, aes(x = factor(SENTIMENT), y = BrojObjava, fill = factor(SENTIMENT))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Sentiment",
y = "Broj Objava",
title = "Sentimenti po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "Sentiment")
gg1 <- dta %>%
group_by(INDUSTRIJA,SENTIMENT) %>%
summarise(BrojObjava = n()) %>%
#  arrange(desc(BrojObjava)) %>%
left_join(industry_list, by = c("INDUSTRIJA" = "id"))
ggplot(gg1, aes(x = factor(SENTIMENT), y = BrojObjava, fill = factor(SENTIMENT))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Sentiment",
y = "Broj Objava",
title = "Sentimenti po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "Sentiment")
sentiment <- data.frame(
number = c(1, 2, 3),
text = c("Pozitivan", "Neutralan", "Negativan")
)
ggplot(data = dta, aes(x = SENTIMENT)) +
geom_histogram(binwidth = 0.5, fill = "blue", alpha = 0.7) +
ggtitle("Sentiment") +
xlab("Sentiment") +
ylab("Frequency") #+
autorstvo <- data.frame(
number = c(1, 2, 3, 4, 5, 6, 7, 8),
text = c(
"Redakcija / redakcijski izvještaj",
"Inicijali novinara",
"Autor, puno ime i prezime",
"Sponzorirani sadržaj / PR / PR sadržaj",
"Native team / studio",
"Ime i prezime autora / sponzorirani sadržaj",
"Nije naveden autor",
"Organizacija / udruga / tvrtka / zajednica"
)
)
gg2 <- dta %>%
group_by(AUTORSTVO,FROM) %>%
summarise(BrojObjava = n())
gg2
AUTORSTVO
gg2
autorstvo
gg2
gg2 <- dta %>%
group_by(AUTORSTVO,FROM) %>%
summarise(BrojObjava = n()) %>%
#  arrange(desc(BrojObjava)) %>%
left_join(industry_list, by = c("AUTORSTVO" = "number"))
dta %>%
group_by(AUTORSTVO,FROM) %>%
summarise(BrojObjava = n())
autorstvo
dta %>%
group_by(AUTORSTVO,FROM) %>%
summarise(BrojObjava = n())
gg2 <- dta %>%
group_by(AUTORSTVO,FROM) %>%
summarise(BrojObjava = n()) %>%
#  arrange(desc(BrojObjava)) %>%
left_join(autorstvo, by = c("AUTORSTVO" = "number"))
gg2
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
labs(
x = "Sentiment",
y = "Broj Objava",
title = "Sentimenti po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "Sentiment")
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
labs(
x = "Sentiment",
y = "Broj Objava",
title = "Sentimenti po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "Sentiment")
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
labs(
x = "Autorstvo",
y = "Broj Objava",
title = "Autorstvo po Medijima"
) +
theme_minimal()
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
labs(
x = "Autorstvo",
y = "Broj Objava",
title = "Autorstvo po Medijima"
) +
theme_minimal() +
scale_fill_discrete(name = "text")
poveznice <- data.frame(
number = c(1, 2, 3, 4, 5, 6),
text = c(
"Društvene mreže",
"Službena internetska stranica brenda",
"Neka druga poveznica (druga web stranica)",
"Članak ne sadrži poveznice na kanale brenda / oglašivača",
"Kolaboracija (Oglašivač + neki drugi brend)",
"Više kombinacija"
)
)
dta %>%
group_by(POVEZNICE.KANALI) %>%
summarise(BrojObjava = n()) %>%
arrange(desc(BrojObjava)) %>%
left_join(poveznice, by = c("POVEZNICE.KANALI" = "number")) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
gg3 <- dta %>%
group_by(POVEZNICE.KANALI,INDUSTRIJA) %>%
summarise(BrojObjava = n()) %>%
left_join(poveznice, by = c("POVEZNICE.KANALI" = "number"))
gg3
ggplot(gg3, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Poveznice na kanale po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "text")
```{r echo=F, eval=T, message=F , warning= FALSE, fig.height=15, fig.width=15}
ggplot(gg3, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Poveznice na kanale po Industrijama"
) +
theme_minimal() +
scale_fill_discrete(name = "text")
ggplot(gg3, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Poveznice na kanale po Industrijama"
) +
theme_minimal()
doseg <- data.frame(
number = c(1, 2, 3, 4, 5, 6, 7),
text = c(
"0 - 2 000",
"2 000 - 5 000",
"5 000 - 10 000",
"10 000 - 20 000",
"20 000 - 50 000",
"50 000 - 100 000",
"100 000 - 200 000"
)
)
gg4 <- dta %>%
group_by(DOSEG.PUBLIKE,INDUSTRIJA) %>%
summarise(BrojObjava = n())  %>%
left_join(doseg, by = c("DOSEG.PUBLIKE" = "number"))
gg4
ggplot(gg4, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg4, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
n_tokenTidy
# read in lexicons
CroSentilex_n <- read.delim("C:/Users/Lukas/Dropbox/Mislav@Luka/crosentilex-negatives.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE,
fileEncoding = "UTF-8")  %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "NEG")
CroSentilex_p  <- read.delim("C:/Users/Lukas/Dropbox/Mislav@Luka/crosentilex-positives.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE,
fileEncoding = "UTF-8") %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "POZ")
Crosentilex_sve <- rbind(setDT(CroSentilex_n), setDT(CroSentilex_p))
# check lexicon data
#head(sample_n(Crosentilex_sve,1000),15)
CroSentilex_Gold  <- read.delim2("C:/Users/Lukas/Dropbox/Mislav@Luka/gs-sentiment-annotations.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" )
Encoding(CroSentilex_Gold$word) <- "UTF-8"
CroSentilex_Gold[1,1] <- "dati"
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "-", "1")
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "\\+", "2")
CroSentilex_Gold$sentiment <- as.numeric(unlist(CroSentilex_Gold$sentiment))
# check lexicon data
#head(sample_n(CroSentilex_Gold,100),15)
# create stop words
stopwords_cro <- get_stopwords(language = "hr", source = "stopwords-iso")
# check stopwords data
#head(sample_n(stopwords_cro,100),15)
# extend stop words
my_stop_words <- tibble(
word = c(
"jedan","mjera", "može", "možete", "mogu", "kad", "sada", "treba", "ima", "osoba",
"e","prvi", "dva","dvije","drugi",
"tri","treći","pet","kod",
"ove","ova",  "ovo","bez", "kod",
"evo","oko",  "om", "ek",
"mil","tko","šest", "sedam",
"osam",   "čim", "zbog",
"prema", "dok","zato", "koji",
"im", "čak","među", "tek",
"koliko", "tko","kod","poput",
"baš", "dakle", "osim", "svih",
"svoju", "odnosno", "gdje",
"kojoj", "ovi", "toga",
"ubera", "vozača", "hrvatskoj", "usluge", "godine", "više", "taksi", "taxi", "taksija", "taksija", "kaže", "rekao", "19"," aee", "ae","bit.ly", "https", "one", "the"
),
lexicon = "lux"
)
stop_corpus <- my_stop_words %>%
bind_rows(stopwords_cro)
# check stopwords data
#head(sample_n(stop_corpus,100),15)
# dim before tokenize
#dim(dta)
# tokenize
dta %>%
unnest_tokens(word, FULL_TEXT) -> n_token
# dim after tokenize
#dim(n_token)
# check
# fb_token %>%
#   select(FROM, word, MENTION_SNIPPET ) %>%
#     sample_n(.,100)
# remove stop words, numbers, single letters
n_token %>%
anti_join(stop_corpus, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) -> n_tokenTidy
# remove NA
n_tokenTidy %>%
filter(!is.na(word)) -> n_tokenTidy
# check
# fb_tokenTidy  %>%
#   select(FROM, word, MENTION_SNIPPET ) %>%
#   sample_n(.,100)
# dim after clean
#dim(n_tokenTidy)
# dim before tokenize
#dim(dta)
# tokenize
dta %>%
unnest_tokens(word, FULL_TEXT) -> n_token
# dim after tokenize
#dim(n_token)
# check
# fb_token %>%
#   select(FROM, word, MENTION_SNIPPET ) %>%
#     sample_n(.,100)
# remove stop words, numbers, single letters
n_token %>%
anti_join(stop_corpus, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) -> n_tokenTidy
# remove NA
n_tokenTidy %>%
filter(!is.na(word)) -> n_tokenTidy
# check
# fb_tokenTidy  %>%
#   select(FROM, word, MENTION_SNIPPET ) %>%
#   sample_n(.,100)
# dim after clean
#dim(n_tokenTidy)
n_tokenTidy %>%
group_by(word) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 50) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 50) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
gg5 <- n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 50)
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
gg5 <- n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 100)
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
gg5 <- n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 20)
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
gg5 <- n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 30)
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
gg5 <- n_tokenTidy %>%
group_by(word, INDUSTRIJA) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
filter(N > 50)
ggplot(gg5, aes(x = factor(word), y = N)) +
geom_bar(stat = "identity") +
coord_flip() +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg4, aes(x = text, y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg4, aes(x = text, y = BrojObjava)) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg4, aes(x = text, y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg4, aes(x = text, y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ INDUSTRIJA, scales = "free_y") +
labs(
x = "Industrija",
y = "Broj Objava",
title = "Doseg publike po Industrijama"
) +
theme_minimal()
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
coord_flip() +
labs(
x = "Autorstvo",
y = "Broj Objava",
title = "Autorstvo po Medijima"
) +
theme_minimal() +
scale_fill_discrete(name = "text")
ggplot(gg2, aes(x = factor(text), y = BrojObjava, fill = factor(text))) +
geom_bar(stat = "identity") +
facet_wrap(~ FROM, scales = "free_y") +
#  coord_flip() +
labs(
x = "Autorstvo",
y = "Broj Objava",
title = "Autorstvo po Medijima"
) +
theme_minimal() +
scale_fill_discrete(name = "text")
