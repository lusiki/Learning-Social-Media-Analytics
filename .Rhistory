slice_max(order_by = views, n= 50)
ytLag %>% group_by(lang) %>%
top_n(50, wt= views)
ytLag %>% group_by(lang) %>%
top_n(50, wt= views) %>%
count()
ytLang %>%
arrange(desc(views)) %>%
group_by(lang) %>%
slice(1:50)
ytLag %>%
arrange(desc(views)) %>%
group_by(lang) %>%
slice(1:50)
ytLag %>%
arrange(desc(views)) %>%
group_by(lang) %>%
slice(1:20)
ytLag %>%
arrange(desc(views)) %>%
group_by(lang) %>%
slice(1:5)
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
group_by(lang) %>%
slice(1:5)
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
group_by(lang) %>%
do(head(.,5))
ytLag %>%
ungroup() %>%
arrange(desc(views))
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,5)) %>%
group_by(lang)
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,50)) %>%
group_by(lang)
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,50)) %>%
group_by(lang) %>%
count
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,80)) %>%
group_by(lang) %>%
count
ytLag %>% group_by(lang) %>% count()
arrange(desc(views)) %>%
top_n(views,50) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,80)) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(subscribers)) %>%
#  do(head(.,80)) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(subscribers)) %>%
do(head(.,50)) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(views)) %>%
do(head(.,50)) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(subscribers)) %>%
do(head(.,50)) %>%
group_by(lang) %>%
count()
ytLag %>%
ungroup() %>%
arrange(desc(subscribers)) %>%
do(head(.,99)) %>%
group_by(lang) %>%
count()
options(scipen = 999)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "1-10k",
"(1e+04,1e+05]" = "10-100k",
"(1e+05,2e+05]" = "100-200k",
"(2e+05,3e+05]" = "200-300k",
"(3e+05,4e+05]" = "300-400k",
"(4e+05,5e+05]" = "400-500k",
"(5e+05,1e+06]" = "500-600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number, -Ranges)
gghist <- hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Broj") +
xlab("Broj pretplatnika") +
ggtitle("Hrvatski YouTube kanali po veličini")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text.x=element_text(angle=45,hjust=1))
gghist
#img <- jpeg::readJPEG("../Foto/yt8.jpg")
yt %>%
group_by(genre) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pretplatnici = sum(subscribers, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE)) %>%
slice(-1) %>%
ungroup() %>%
gather(., Category, Number, Kanali,Video,Pretplatnici,Pregledi) %>%
ggplot(., aes(x = Number, y = reorder(genre,Number))) +
# background_image(img) +
geom_bar(stat = "identity", alpha = 1) +
ylab("Kategorija") +
xlab("Broj") +
ggtitle("Najveći hrvatski Youtube kanali po kategorijama ")+
theme_bw() +
facet_wrap(~Category, scales = "free") +
scale_x_continuous(labels = scales::comma) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
options(digits = 2, scipen = 999)
rangesCategory <- ranges %>%
group_by(Ranges) %>%
mutate(channels = n()) %>%
gather(.,Category, Number,videos, subscribers, views,channels) %>%
ungroup() %>%
group_by(Category) %>%
mutate(Total = sum(Number, na.rm = TRUE)) %>%
mutate("Share %" = (Number / Total)*100) %>%
select(- Total) %>%
#ungroup() %>%
arrange(desc(`Share %`),.by_group = TRUE)
options(digits = 2, scipen = 999)
ranges <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges =recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
mutate(Ranges = as.character(Ranges))
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Kanali = n(),
Video = sum(videos, na.rm = TRUE),
Pretplatnici = sum(subscribers, na.rm = TRUE),
Pregledi = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5) %>%
arrange(factor(Ranges,
levels = c("Bube", "Glodavci", "Sisavci","Dinosauri")))
rangesGeneral %>%
kable(format.args = list(decimal.mark = ',', big.mark = "."),
caption = "Agregatni pregled metrika prema veličini kanala") %>%
kable_styling()
options(digits = 2, scipen = 999)
rangesCategory <- ranges %>%
group_by(Ranges) %>%
mutate(channels = n()) %>%
gather(.,Category, Number,videos, subscribers, views,channels) %>%
ungroup() %>%
group_by(Category) %>%
mutate(Total = sum(Number, na.rm = TRUE)) %>%
mutate("Share %" = (Number / Total)*100) %>%
select(- Total) %>%
#ungroup() %>%
arrange(desc(`Share %`),.by_group = TRUE)
rangesCategory %>%
kable(format.args = list(decimal.mark = ',', big.mark = ".")) %>%
kable_styling()
options(digits = 2, scipen = 999)
descriptivesChannel <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
select(-link,-lastvideo,-X,-name,-genre) %>%
#  group_by(Ranges) %>%
#  mutate(channels = n()) %>%
ungroup() %>%
gather(.,Category, Number, videos, subscribers, views)  %>%
mutate(Category = recode_factor(.$Category,
"videos" = "Video",
"subscribers" = "Pretplatnici",
"views" = "Pregledi")) %>%
#  group_by(Category,Ranges ) %>%
# summarise(Mean = mean(Number,na.rm = TRUE),
#           Median = median(Number,na.rm = TRUE),
#           std = sd(Number, na.rm = TRUE)) %>%
na.omit()
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." )) +
ggtitle("Prosjek metrika prema prema veličini kanala")
dscGG
dscTABLE <- descriptivesChannel %>%
kable(format.args = list(decimal.mark = ',', big.mark = "."),
caption = "Pregled srednjih veličina po kanalu") %>%
kable_styling()
dscGG
img <- jpeg::readJPEG("../Foto/yt8.jpg")
calc_stat <- function(x) {
coef <- 1.5
n <- sum(!is.na(x))
# calculate quantiles
stats <- quantile(x, probs = c(0.1, 0.25, 0.5, 0.75, 0.9))
names(stats) <- c("ymin", "lower", "middle", "upper", "ymax")
return(stats)
}
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
background_image(img) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." )) +
ggtitle("Prosjek metrika prema prema veličini kanala")
dscGG
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
background_image(img) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." )) +
ggtitle("Prosjek metrika prema prema veličini kanala")
dscGG
img
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
#  background_image(img) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Veličina kanala") +
ylab("Broj") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." )) +
ggtitle("Prosjek metrika prema prema veličini kanala")
dscGG
dscGG <- descriptivesChannel %>%
ggplot(.,aes(Ranges,Number)) +
#  background_image(img) +
stat_summary(fun.data = calc_stat, geom="boxplot") +
facet_wrap(~Category,scales = "free") +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("") +
ylab("") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5),labels = scales::number_format( big.mark = "." )) +
ggtitle("")
dscGG
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(cowplot)
library(magick)
library(png)
library(RCurl)
library(patchwork)
library(grid)
library(ggpubr)
library(scales)
library(kableExtra)
yt <- read.csv2("../data/YouTube/YT.csv")
options(digits = 2, scipen = 999)
genreBYrange <- ranges %>%
select(-X, -name,- link,-lastvideo) %>%
gather(., Category, Number, subscribers, videos, views) %>%
group_by(Category) %>%
mutate(TotBYcategory = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges) %>%
mutate(TotBYCategoryANDRange = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges,genre,TotBYCategoryANDRange,TotBYcategory) %>%
summarise(TotBYCategoryANDRangeANDGenre = sum(Number, na.rm = TRUE)) %>%
mutate(`Share %` = (TotBYCategoryANDRangeANDGenre / TotBYCategoryANDRange)*100) %>%
na.omit() %>%
filter(genre != "")
ranges <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges =recode_factor(.$Ranges,
"(0,1e+03]" = "Bube",
"(1e+03,1e+04]" = "Glodavci",
"(1e+04,1e+05]" = "Sisavci",
"(1e+05,Inf]" = "Dinosauri")) %>%
mutate(Ranges = as.character(Ranges))
genreBYrange <- ranges %>%
select(-X, -name,- link,-lastvideo) %>%
gather(., Category, Number, subscribers, videos, views) %>%
group_by(Category) %>%
mutate(TotBYcategory = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges) %>%
mutate(TotBYCategoryANDRange = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges,genre,TotBYCategoryANDRange,TotBYcategory) %>%
summarise(TotBYCategoryANDRangeANDGenre = sum(Number, na.rm = TRUE)) %>%
mutate(`Share %` = (TotBYCategoryANDRangeANDGenre / TotBYCategoryANDRange)*100) %>%
na.omit() %>%
filter(genre != "")
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bube", "Glodavci", "Sisavci","Dinosauri")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Velicina kanala") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15)) +
ggtitle("Relativni prikaz metrika po kategorijama i veličini kanala")
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bube", "Glodavci", "Sisavci","Dinosauri")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Velicina kanala") +
ylab("Udio %") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15)) +
ggtitle("Relativni prikaz metrika po kategorijama i veličini kanala")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(cowplot)
library(magick)
library(png)
library(RCurl)
library(patchwork)
library(grid)
library(ggpubr)
library(scales)
library(kableExtra)
yt <- read.csv2("../data/YouTube/YT.csv")
View(yt)
yt %>% mutate(id = str_sub(link,-1,-25))
yt %>% mutate(id = str_sub(link,-25))
yt %>% mutate(id = str_sub(link,-24))
yt %>% mutate(id = str_sub(link,-24)) %>% select(id)
yt %>%
mutate(id = str_sub(link,-24)) %>%
select(id) %>%
mutate(id = paste(id,sep = ","))
yt %>%
mutate(id = str_sub(link,-24)) %>%
select(id) -> id
ids <- paste(id,sep = ",")
View(id)
ids
ids <- paste0(id,sep = ",")
ids <- paste0(id,sep = "")
ids
ids <- paste0(id,sep = ".")
ids
View(id)
ids <- paste(id,collapse = ",")
ids
ids <- paste(id,collapse = "I")
ids
ids <- paste(id,collapse = ".")
paste(id,collapse = ".")
ids <- paste(id$id,collapse = ".")
ids
ids <- paste(id$id,collapse = ",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(cowplot)
library(magick)
library(png)
library(RCurl)
library(patchwork)
library(grid)
library(ggpubr)
library(scales)
library(kableExtra)
yt <- read.csv2("../data/YouTube/YT.csv")
yt %>%
mutate(id = str_sub(link,-24)) %>%
select(id) -> id
View(id)
ids <- paste(id$id,collapse = ",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
paste(id$id,collapse = ",")
apply(id$id, seq(1,100,1)
)
apply(id$id, seq(1,100,1))
nrow(id)
list_output <- lapply(seq_len(nrow(id) - 99), function(x) id[x:(x+99), ])
list_output
seq_len(14)
list_output <- lapply(seq_len(14, function(x) paste(x$id,collapse = ",") )
list_output <- lapply(seq_len(14, function(x) paste(x$id,collapse = ",") )
list_output <- lapply(seq_len(14, function(x) paste(x$id,collapse = ",") ))
n <- 100
nrow(id) - n
for (i in 1:(nrow(id) - n))
for (i in 1:(nrow(id) - n))
l[[i]] <- id[i:(i+n-1),]
n <- 100
l <- list()
for (i in 1:(nrow(id) - n))
l[[i]] <- id[i:(i+n-1),]
1:(nrow(id) - n)
split(id, seq(nrow(id)) %/% n)
l <- split(id, seq(nrow(id)) %/% n)
View(l)
View(l)
ids <- lapply(listID, paste, collapse=",")
listID <- split(id, seq(nrow(id)) %/% n)
ids <- lapply(listID, paste, collapse=",")
View(ids)
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
ids <- sapply(listID, paste, collapse=",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
yt %>%
mutate(id = str_sub(link,-24)) %>%
select(id) -> id
ids <- paste(id$id,collapse = ",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
listID <- split(id, seq(nrow(id)) %/% n)
str(listID)
library(purrr)
ids <- listID %>%
map_chr(paste, collapse = ",")
ids <- listID %>%
map_chr(paste, collapse = ",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
ids <- listID %>%
map(paste, collapse = ",")
ids <- listID %>%
map(paste0, collapse = ",")
write.table(ids, "C:/Users/Lukas/OneDrive/Desktop/ytid.txt")
mylist<- list(c("PDLIM5", "CBG"), c("PDLIM5", "GTA"), "DDX60")
mylist
listID
