theme_bw() +
scale_x_continuous(labels = scales::comma) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,n)) +
geom_bar(stat = "identity") +
ylab("Number of channels") +
xlab("") +
ggtitle("Distribution of Croatian YouTube channels by subscriber size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarize(Channels = count(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(Views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = count(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(Views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = nrow(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(Views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = count(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(Views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(Views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE))
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number, Ranges)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "10k",
"(1e+04,1e+05]" = "100k",
"(1e+05,2e+05]" = "200k",
"(2e+05,3e+05]" = "300k",
"(3e+05,4e+05]" = "400k",
"(4e+05,5e+05]" = "500k",
"(5e+05,1e+06]" = "600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number, -Ranges)
hist %>% ggplot(.,aes(Ranges,n)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_x_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by subscriber size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,n)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
#  scale_x_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by subscriber size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
#  scale_x_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by subscriber size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by subscriber size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by  size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
View(yt)
hist <- yt %>%
mutate(Ranges = cut(subscribers,c(0,100,1000,10000,100000,200000,300000,400000,500000,1000000, Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,100]" = "100",
"(100,1e+03]" = "1k",
"(1e+03,1e+04]" = "1-10k",
"(1e+04,1e+05]" = "10-100k",
"(1e+05,2e+05]" = "100-200k",
"(2e+05,3e+05]" = "200-300k",
"(3e+05,4e+05]" = "300-400k",
"(4e+05,5e+05]" = "400-500k",
"(5e+05,1e+06]" = "500-600k",
"(1e+06,Inf]"   = "+1mil")) %>%
na.omit(.) %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Subscribers = sum(subscribers, na.rm = TRUE),
Videos = sum(videos, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
gather(.,Category,Number, -Ranges)
hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by  size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by  size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text.x=element_text(angle=45,hjust=1))
gghist <- hist %>% ggplot(.,aes(Ranges,Number)) +
geom_bar(stat = "identity") +
facet_wrap(~Category, scales = "free") +
scale_y_continuous(labels = scales::comma) +
ylab("Number of channels") +
xlab("") +
ggtitle("Croatian YouTube channels by  size")+
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text.x=element_text(angle=45,hjust=1))
gghist
#img <- jpeg::readJPEG("../Foto/yt8.jpg")
yt %>%
group_by(genre) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
slice(-1) %>%
ungroup() %>%
gather(., Category, Number, Channels,Videos,Subscribers,Views) %>%
ggplot(., aes(x = Number, y = reorder(genre,Number))) +
# background_image(img) +
geom_bar(stat = "identity", alpha = 1) +
ylab("") +
xlab("Number") +
ggtitle("Top (1k) Croatian YouTube channels by genre")+
theme_bw() +
facet_wrap(~Category, scales = "free") +
scale_x_continuous(labels = scales::comma) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
yt %>%
group_by(genre) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
slice(-1) %>%
ungroup() %>%
gather(., Category, Number, Channels,Videos,Subscribers,Views) %>%
ggplot(., aes(x = Number, y = reorder(genre,Number))) +
# background_image(img) +
geom_bar(stat = "identity", alpha = 1) +
ylab("") +
xlab("Number") +
ggtitle("Top (1k) Croatian YouTube channels by genre")+
theme_bw() +
facet_wrap(~Category, scales = "free") +
scale_x_continuous(labels = scales::comma) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
options(digits = 2, scipen = 999)
ranges <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bugs",
"(1e+03,1e+04]" = "Rodents",
"(1e+04,1e+05]" = "Mammals",
"(1e+05,Inf]" = "Dinosours")) %>%
mutate(Ranges = as.character(Ranges))
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5)
rangesGeneral %>%
kable(format.args = list(decimal.mark = ',', big.mark = ".")) %>%
kable_styling()
options(digits = 2, scipen = 999)
ranges <- yt %>%
mutate(Ranges = cut(subscribers,c(0,1000,10000,100000,Inf))) %>%
mutate(Ranges = recode_factor(.$Ranges,
"(0,1e+03]" = "Bugs",
"(1e+03,1e+04]" = "Rodents",
"(1e+04,1e+05]" = "Mammals",
"(1e+05,Inf]" = "Dinosours")) %>%
mutate(Ranges = as.character(Ranges))
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5)
View(rangesGeneral)
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5) %>%
arrange(match(Ranges, c("Bugs", "Rodents", "Mammmals", "Dinosours")))
rangesGeneral %>%
kable(format.args = list(decimal.mark = ',', big.mark = "."),caption = "This is the table caption") %>%
kable_styling()
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5) %>%
arrange(match(Ranges, c("Bugs", "Rodents", "Mammmals", "Dinosours")))
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5) %>%
arrange(match(Ranges, c("Bugs", "Rodents", "Mammmals", "Dinosours")))
rangesGeneral <- ranges %>%
group_by(Ranges) %>%
summarise(Channels = n(),
Videos = sum(videos, na.rm = TRUE),
Subscribers = sum(subscribers, na.rm = TRUE),
Views = sum(views, na.rm = TRUE)) %>%
ungroup() %>%
slice(-5) %>%
arrange(factor(Ranges, levels = c("Bugs", "Rodents", "Mammals","Dinosours")))
rangesGeneral %>%
kable(format.args = list(decimal.mark = ',', big.mark = "."),caption = "This is the table caption") %>%
kable_styling()
options(digits = 2, scipen = 999)
rangesCategory <- ranges %>%
gather(.,Category, Number,videos, subscribers, views) %>%
group_by(Category) %>%
mutate(Total = sum(Number, na.rm = TRUE)) %>%
mutate("Share %" = (Number / Total)*100) %>%
select(- Total) %>%
#ungroup() %>%
arrange(desc(`Share %`),.by_group = TRUE)
rangesCategory %>%
kable(format.args = list(decimal.mark = ',', big.mark = ".")) %>%
kable_styling()
rangesCategory %>%
kable(format.args = list(decimal.mark = ',', big.mark = ".")) %>%
kable_styling()
options(digits = 2, scipen = 999)
rangesCategory <- ranges %>%
gather(.,Category, Number,videos, subscribers, views) %>%
group_by(Category) %>%
mutate(Total = sum(Number, na.rm = TRUE)) %>%
mutate("Share %" = (Number / Total)*100) %>%
select(- Total) %>%
#ungroup() %>%
arrange(desc(`Share %`),.by_group = TRUE)
rangesCategory %>%
kable(format.args = list(decimal.mark = ',', big.mark = ".")) %>%
kable_styling()
genreBYrange <- ranges %>%
select(-X, -name,- link,-lastvideo) %>%
gather(., Category, Number, subscribers, videos, views) %>%
group_by(Category) %>%
mutate(TotBYcategory = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges) %>%
mutate(TotBYCategoryANDRange = sum(Number, na.rm = TRUE)) %>%
ungroup() %>%
group_by(Category,Ranges,genre,TotBYCategoryANDRange,TotBYcategory) %>%
summarise(TotBYCategoryANDRangeANDGenre = sum(Number, na.rm = TRUE)) %>%
mutate(`Share %` = (TotBYCategoryANDRangeANDGenre / TotBYCategoryANDRange)*100) %>%
na.omit() %>%
filter(genre != "")
genreBYrange %>%
#   filter(`Share %` >= 6) %>%
ggplot(.,aes(x = factor(Ranges, level = c("Bugs", "Rodents", "Mammals","Dinosours")),
y = `Share %`, group= genre)) +
geom_line(aes(color=genre),size = 1.5) +
geom_point(aes(color=genre),size = 3) +
facet_wrap(~Category) +
theme_bw(base_size = 16) +
theme(axis.text.x=element_text(angle=45,hjust=1)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title=element_blank()) +
xlab("Channel size") +
scale_y_continuous(breaks = scales::pretty_breaks(n = 15))
