}
library(rvest)
library(tidyverse)
library(httr)
parsanjeClanaka(x)
parsanjeClanaka(clanak = "x")
parsanjeClanaka(clanak = x)
parsanjeClanaka("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
pageRequest("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
p <- pageRequest("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
parsanjeClanaka(p)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/eksplozije-odjekuju-oko-grada-lavova-celnik-nato-a-rusija-bi-mogla-upotrijebiti-kemijsko-oruzje-1570432"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
clanaki
clanaki
parsanjeClanaka(p)
clanak1 <- "hhttps://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "hhttps://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/eksplozije-odjekuju-oko-grada-lavova-celnik-nato-a-rusija-bi-mogla-upotrijebiti-kemijsko-oruzje-1570432"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak2 <- "https://www.vecernji.hr/vijesti/u-kijevu-pogodena-stambena-zgrada-objavljena-snimka-raketiranja-nebodera-u-mariupolju-1570614"
p <- pageRequest(clanak2)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanaki
##### gentelman`s way = API
knitr::opts_chunk$set(echo = T, message = F, warning = F)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, ,tekst, stringsAsFactors = FALSE)
return(clanaki)
}
# 1. copy urls
url1 <- "https://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
url2 <- "https://www.vecernji.hr/vijesti/u-kijevu-pogodena-stambena-zgrada-objavljena-snimka-raketiranja-nebodera-u-mariupolju-1570614"
# 2. request page
page1 <- pageRequest(url1)
library(tidyverse)
library(readxl)
library(here)
library(kableExtra)
library(DT)
library(rvest)
library(tidyverse)
library(httr)
# 2. request page
page1 <- pageRequest(url1)
# 2. request page
page1 <- pageRequest(url1)
url1 <- "https://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
page1 <- pageRequest(url1)
# 2. request page
page1 <- html_session(url1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, ,tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(page1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(page1)
# 3. write a function to take parts of the article
parseArticle <- function(webpage) {
title <- html_nodes(webpage, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
article <- html_nodes(webpage, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
articles <- cbind.data.frame(title, article, stringsAsFactors = FALSE)
return(articles)
}
data <- parseArticle("page1")
data <- parseArticle(page1)
data
# 3. write a function to take parts of the article
parseArticle <- function(webpage) {
title <- html_nodes(webpage, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
article <- html_nodes(webpage, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
numberOfComments <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articles <- cbind.data.frame(title, article, numberOfComments, stringsAsFactors = FALSE)
return(articles)
}
pages <- c(page1, page2)
page2 <- html_session(url2)
pages <- c("page1", "page2")
# 4. apply the function
data <- lapply(parseArticle,pages)
# 4. apply the function
data <- lapply(pages,parseArticle)
# 4. apply the function
data <- parseArticle(page1)
s
# 3. write a function to take parts of the article
parseArticle <- function(webpage) {
title <- html_nodes(webpage, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
article <- html_nodes(webpage, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
numberOfComments <- html_nodes(webpage, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articles <- cbind.data.frame(title, article, numberOfComments, stringsAsFactors = FALSE)
return(articles)
}
# 4. apply the function
data <- parseArticle(page1)
# 5. check the data
str(data)
data$title
data$numberOfComments
length(data$article)
nchar(data$article)
