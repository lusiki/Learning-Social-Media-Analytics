clanciPoveznice,
XpathPatterns = c(
'//h1[@class="article__title"]/text()',
'//span[@class="article__header_date"]',
'//span[@class="article__comments_number"]/a/strong/span/text()',
'//*[@class="article__comments_number"]/a//@href',
'//span[@class="article__header_views"]/strong/text()',
'//*[@class="article__label"]/text()',
'//*[@class="article__author--link"]',
'//*[@class="article__body--main_content"]/p',
'//*[@class="article__tag_name"]'
),
PatternsName = c('naslov', "datum", "brojKomentara", "komentariPoveznica", "brojPrikaza",
"articleLabel", "autor", "tekst", "kljucneRijeci"),
ManyPerPattern = TRUE
)
clancijClean <- lapply(clanci, function(x) {
x <- lapply(x, trimws)
# x[c("brojKomentara", "brojPrikaza")] <- as.numeric(x[c("brojKomentara", "brojPrikaza")])
# x["autor"] <- paste0(unlist(x["autor"]), collapse = ";")
# x["kljucneRijeci"] <- paste0(unlist(x["kljucneRijeci"]), collapse = ";")
# x["tekst"] <- str_flatten(unlist(x["tekst"]), "\n")
# x["tekst"] <- str_replace_all(x["tekst"], ">>.*\n", "")
# x["komentariPoveznica"] <- paste0("https://www.vecernji.hr", x["komentariPoveznica"])
x
})
clancijClean <- lapply(clancijClean, unlist)
clancijClean <- do.call(rbind, clancijClean)
clanakj[[i]] <- as.tibble(clancijClean)
}
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text()
stranice
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
'/'(20) %>%
ceiling(.) %>%
2:. %>%
paste0(url, "&page=", .) %>%
c(url, .)
url <- paste0("https://www.vecernji.hr/pretraga?query=",
"&order=-publish_from&",
"date_from=", datumi[1], "&date_to=", datumi[2])
p <- pageRequest(url)
p
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
'/'(20) %>%
ceiling(.) %>%
2:. %>%
paste0(url, "&page=", .) %>%
c(url, .)
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text() %>%
str_extract("\\d+") %>%
as.numeric(.)
stranice
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
'/'(20) %>%
ceiling(.) %>%
2:. %>%
paste0(url, "&page=", .) %>%
c(url, .)
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text()
stranice
stranice <- p %>%
html_nodes(xpath = '//div[@class="search__content--title"]/h3') %>%
html_text() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
'/'(20) %>%
ceiling(.)
stranice
pgs <- paste0("https://www.jutarnji.hr/search/?order=DESC&page=", 3184:12500, "&q=a&sort=publishdate")
pgs
url <- paste0("https://www.vecernji.hr/pretraga?query=",
"&order=-publish_from&",
"date_from=", datumi[1], "&date_to=", datumi[2])
url
clanakj <- list()
x <- "https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680"
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(idClanka, naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
library(rvest)
library(tidyverse)
library(httr)
parsanjeClanaka(x)
parsanjeClanaka(clanak = "x")
parsanjeClanaka(clanak = x)
parsanjeClanaka("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
pageRequest("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
p <- pageRequest("https://www.vecernji.hr/vijesti/zbog-putinove-invazije-raste-opasnost-za-bih-moze-li-doci-do-novog-rata-na-balkanu-1570680")
parsanjeClanaka(p)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/eksplozije-odjekuju-oko-grada-lavova-celnik-nato-a-rusija-bi-mogla-upotrijebiti-kemijsko-oruzje-1570432"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
clanaki
clanaki
parsanjeClanaka(p)
clanak1 <- "hhttps://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "hhttps://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/eksplozije-odjekuju-oko-grada-lavova-celnik-nato-a-rusija-bi-mogla-upotrijebiti-kemijsko-oruzje-1570432"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak1 <- "https://www.vecernji.hr/vijesti/umro-bivsi-austrijski-potkancelar-i-prijatelja-hrvatske-dr-erhard-busek-1570780"
p <- pageRequest(clanak1)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanak2 <- "https://www.vecernji.hr/vijesti/u-kijevu-pogodena-stambena-zgrada-objavljena-snimka-raketiranja-nebodera-u-mariupolju-1570614"
p <- pageRequest(clanak2)
parsanjeClanaka <- function(clanak) {
naslov <- html_nodes(clanak, xpath = '//h1[@class="article__title"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
datum <- html_nodes(clanak, xpath = '//*[@class="article__header_date"]') %>%
html_text() %>%
str_replace_all(pattern = "\\\r\\\n| u", replacement = "") %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
brojKomentara <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
komentariPoveznica <- html_nodes(clanak, xpath = '//*[@class="article__comments_number"]') %>%
html_nodes("a") %>%
html_attr("href") %>%
paste0("https://www.vecernji.hr", .) %>%
ifelse(length(.) == 0, NA, .)
brojPrikaza <- html_nodes(clanak, xpath = '//*[@class="article__header_views"]') %>%
html_text() %>%
trimws() %>%
str_extract("\\d+") %>%
as.numeric(.) %>%
ifelse(length(.) == 0, NA, .)
articleLabel <- html_nodes(clanak, xpath = '//*[@class="article__label"]') %>%
html_text() %>%
trimws() %>%
ifelse(length(.) == 0, NA, .)
autor <- html_nodes(clanak, xpath = '//*[@class="article__author--link"]') %>%
html_text() %>%
trimws()
if (length(autor) == 0) {autor <- NA}
tekst <- html_nodes(clanak, xpath = '//*[@class="article__body--main_content"]/p') %>%
html_text() %>%
str_flatten(., "\n") %>%
ifelse(length(.) == 0, NA, .)
kljucneRijeci <- html_nodes(clanak, xpath = '//*[@class="article__tag_name"]') %>%
html_text() %>%
trimws() %>%
str_flatten(., ";") %>%
ifelse(length(.) == 0, NA, .)
clanaki <- cbind.data.frame(naslov, datum, brojKomentara, komentariPoveznica, brojPrikaza,
articleLabel, autor, kljucneRijeci, tekst, stringsAsFactors = FALSE)
return(clanaki)
}
parsanjeClanaka(p)
clanaki
##### gentelman`s way = API
