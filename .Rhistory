gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
doprinos_sentimentu(stemmed,30)
doprinos_sentimentu(stemmed,30)
doprinos_sentimentu(stemmed,30)
unique(LilaHR_long$Emotion)
NRC <- LilaHR_long %>% rename("word" = "rijec") %>%
filter(Emotion %in% c("Anger","Anticipation","Disgust","Fear","Joy","Sadness","Surprise","Trust"))
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
doprinos_sentimentu(stemmed,30)
stemmed%>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion) %>%
top_n(no)
stemmed%>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion) %>%
top_n(5)
NRC
LilaHR_long
NRC <- LilaHR_long %>% rename("word" = "korijen") %>%
filter(Emotion %in% c("Anger","Anticipation","Disgust","Fear","Joy","Sadness","Surprise","Trust"))
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion,) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
NRC <- LilaHR_long %>% rename("word" = "korijen") %>%
filter(Emotion %in% c("Positive","Negative"))
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
doprinos_sentimentu(stemmed,30)
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment,sort = TRUE) %>%
group_by(sentiment) %>%
top_n(no) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
sentiment == 1 ~ "NEGATIVE",
sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
CroSentilex_Gold
proba <- CroSentilex_Gold %>%
#  slice(1:500) %>%
mutate(
results = map(word, write_tokens),
korijen = map_chr(results, ~ str_extract(.x, "(?<=\t)[^\t]+$")),
rijec = map_chr(results, ~ str_extract(.x, "^[^\t]+(?=\t)"))
) %>%
select(-results)
View(proba)
CroSentilex_Gold <- select(-word) %>% rename("word" ="korijen")
CroSentilex_Gold
CroSentilex_Gold <- proba %>% select(-"word") %>% rename("word" ="korijen")
CroSentilex_Gold
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(CroSentilex_Gold, by = "word") %>%
count(word, sentiment,sort = TRUE) %>%
group_by(sentiment) %>%
top_n(no) %>%
ungroup() %>%
mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
sentiment == 1 ~ "NEGATIVE",
sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = sentiment)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ sentiment, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
## ComparisonCloud
stemmed %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "24sata.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "vecernji.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "jutarnji.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "index.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "slobodnadalmacija.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(FROM == "telegram.hr") %>%
inner_join(CroSentilex_Gold,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
sentiment == 1 ~ "-",
sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
NRC <- LilaHR_long %>% rename("word" = "korijen") %>%
filter(Emotion %in% c("Positive","Negative"))
NRCpn <- LilaHR_long %>% rename("word" = "korijen") %>%
filter(Emotion %in% c("Positive","Negative"))
## Sentiment
doprinos_sentimentu <- function(dataset, no = n) {
dataset %>%
inner_join(NRCpn, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu(stemmed,30)
stemmed %>%
inner_join(NRCpn,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
inner_join(NRCpn,by="word") %>%
count(word, Emotion) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
inner_join(NRCpn,by="word") %>%
count(word, Emotion) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ Emotion, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
SENTIMENT <- dta %>%
group_by(SENTIMENT) %>%
summarise(N = n()) %>%
mutate(percentSENTIMENT = round(N / sum(N) * 100,2))
SENTIMENT %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
sentiment <- data.frame(
number = c(1, 2, 3),
text = c("Pozitivan", "Neutralan", "Negativan")
)
ggplot(data = dta, aes(x = SENTIMENT)) +
geom_histogram(binwidth = 0.5, fill = "blue", alpha = 0.7) +
ggtitle("Sentiment") +
xlab("Sentiment") +
ylab("Frequency") #+
stemmed %>%
filter(INDUSTRIJA == 1) %>%
inner_join(NRCpn,by="word") %>%
count(word, sentiment) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                 sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ sentiment, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
stemmed %>%
filter(INDUSTRIJA == 1) %>%
inner_join(NRCpn,by="word") %>%
count(word, Emotion) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                 sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ Emotion, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
doprinos_sentimentu(stemmed %>%
filter(INDUSTRIJA == 1),30)
stemmed %>%
filter(INDUSTRIJA == 1) %>%
inner_join(NRCpn,by="word") %>%
count(word, Emotion) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                 sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ Emotion, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
doprinos_sentimentu(stemmed %>%
filter(INDUSTRIJA == 1),30)
doprinos_sentimentu(stemmed %>%
filter(INDUSTRIJA == 1),30)
stemmed %>%
filter(INDUSTRIJA == 11) %>%
inner_join(NRCpn,by="word") %>%
count(word, Emotion) %>%
top_n(200) %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "+/-",
#                                 sentiment == 1 ~ "-",
#                                 sentiment == 2 ~ "+")) %>%
acast(word ~ Emotion, value.var = "n", fill = 0) %>%
comparison.cloud(colors = c("firebrick3", "deepskyblue3","darkslategray"),
max.words = 120)
doprinos_sentimentu(stemmed %>%
filter(INDUSTRIJA == 11),30)
## Sentiment
doprinos_sentimentu_full <- function(dataset, no = n) {
dataset %>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion,) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu_full(stemmed,30)
doprinos_sentimentu_full(stemmed,30)
## Sentiment
doprinos_sentimentu_full <- function(dataset, no = n) {
dataset %>%
inner_join(NRC, by = "word") %>%
count(word, Emotion,sort = TRUE) %>%
group_by(Emotion,) %>%
top_n(no) %>%
ungroup() %>%
#  mutate(sentiment = case_when(sentiment == 0 ~ "NEUTRAL",
#                                 sentiment == 1 ~ "NEGATIVE",
#                                 sentiment == 2 ~ "POSITIVE")) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n, fill = Emotion)) +
geom_col(show.legend = FALSE) +
ggtitle( "Sentiment") +
labs( x = "Riječ", y = "Number of words") +
facet_wrap(~ Emotion, scales = "free_y") +
coord_flip() +
theme_economist() -> gg_doprinos_sentimentu
gg_doprinos_sentimentu
}
doprinos_sentimentu_full(stemmed,30)
NRC <- LilaHR_long %>% rename("word" = "korijen") %>%
filter(Emotion %in% c("Anger","Anticipation","Disgust","Fear","Joy","Sadness","Surprise","Trust"))
doprinos_sentimentu_full(stemmed,30)
Crosentilex_sve
get_sentiments("nrc")
library(textdata)
install.packages("textdata")
library(textdata)
get_sentiments("nrc")
stemmed %>%
inner_join(NRCpn, by = "word") %>%
count(word, Emotion,sort = TRUE)
stemmed %>%
inner_join(NRCpn, by = "word")
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(word, Emotion,sort = TRUE)
View(stemmed)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion,sort = TRUE)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Setiment = Negative - Positive)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Setiment = Positive - Negative)
proba <- stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Setiment = Positive - Negative)
positive_count <- nrow(filter(proba, Sentiment > 0))
proba
positive_count <- nrow(filter(proba, Setiment > 0))
# Count rows with negative sentiment values
negative_count <- nrow(filter(data, Setiment < 0))
positive_count
negative_count
# Count rows with negative sentiment values
negative_count <- nrow(filter(proba, Setiment < 0))
negative_count
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Sentiment = Positive - Negative) %>%
summarise(
positive_count = sum(Sentiment > 0),
negative_count = sum(Sentiment < 0)
)
stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Sentiment = Positive - Negative)
proba <- stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Sentiment = Positive - Negative)
positive_count <- nrow(filter(proba, Setiment > 0))
# Count rows with negative sentiment values
negative_count <- nrow(filter(proba, Setiment < 0))
print(paste("Number of rows with positive sentiment values:", positive_count))
print(paste("Number of rows with negative sentiment values:", negative_count))
proba <- stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Sentiment = Positive - Negative)
positive_count <- nrow(filter(proba, Setiment > 0))
proba <- stemmed %>%
inner_join(NRCpn, by = "word") %>%
group_by(V1) %>%
count(Emotion) %>%
spread(Emotion, n) %>%
mutate(Sentiment = Positive - Negative)
positive_count <- nrow(filter(proba, Sentiment > 0))
negative_count <- nrow(filter(proba, Sentiment < 0))
print(paste("Broj članaka sa  positive sentimentom:", positive_count))
print(paste("Broj članaka sa  negative sentimentom:", negative_count))
CroSentilex_Gold
CroSentilex_Gold  <- read.delim2("C:/Users/Lukas/Dropbox/Mislav@Luka/gs-sentiment-annotations.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" )
Encoding(CroSentilex_Gold$word) <- "UTF-8"
CroSentilex_Gold[1,1] <- "dati"
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "-", "1")
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "\\+", "2")
CroSentilex_Gold$sentiment <- as.numeric(unlist(CroSentilex_Gold$sentiment))
CroSentilex_Gold
