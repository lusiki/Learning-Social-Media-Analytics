unique(tw[,.N,PROFILE][order(-N)]) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most active profiles
unique(tw[,.N,PROFILE][order(-N)]) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most popular
tw %>%
group_by(PROFILE) %>%
summarise(FOLLOW = mean(FOLLOWERS_COUNT)) %>%
arrange(desc(FOLLOW)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most influential
tw %>%
group_by(PROFILE) %>%
summarise(REACH = sum(REACH)) %>%
arrange(desc(REACH)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most influential II
tw %>%
group_by(PROFILE) %>%
summarise(INTERACTIONS = sum(INTERACTIONS)) %>%
arrange(desc(INTERACTIONS)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most appreciated
tw %>%
group_by(PROFILE) %>%
summarise(FAVORITE = sum(FAVORITE_COUNT)) %>%
arrange(desc(FAVORITE)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most appreciated
tw %>%
group_by(PROFILE) %>%
summarise(RETWEET = sum(RETWEET_COUNT)) %>%
arrange(desc(RETWEET)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most popular
tw %>%
select(PROFILE, FULL_TEXT, FOLLOWERS_COUNT,URL) %>%
arrange(desc(FOLLOWERS_COUNT)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# select twitter
tw <- dt %>%
filter(SOURCE_TYPE == "twitter")
# most popular
tw %>%
select(PROFILE, FULL_TEXT, FOLLOWERS_COUNT,URL) %>%
arrange(desc(FOLLOWERS_COUNT)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# PER INFLUENCER
tw <- tw %>%
mutate(PROFILE = gsub("^.*\\.com/([^/]+).*", "\\1", URL))
tw <- as.data.table(tw)
# most popular
tw %>%
select(PROFILE, FULL_TEXT, FOLLOWERS_COUNT,URL) %>%
arrange(desc(FOLLOWERS_COUNT)) %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# select relevant CRO profiles
unique(tw[,.N,FROM][order(-N)]) %>%
filter(N > 5) %>%
pull(FROM) -> CRO_TW
tw[FROM %in% CRO_TW,] -> CTW
CTW %>%
mutate(PROFILE = gsub("^.*\\.com/([^/]+).*", "\\1", URL)) -> CTW
# most popular
CTW %>%
group_by(PROFILE) %>%
summarise(FOLLOW = mean(FOLLOWERS_COUNT)) %>%
arrange(desc(FOLLOW))  %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# most influential
CTW %>%
group_by(PROFILE) %>%
summarise(REACH = sum(REACH)) %>%
arrange(desc(REACH)) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
CRO_TW
# most appreciated
CTW %>%
group_by(PROFILE) %>%
summarise(RETWEET = sum(RETWEET_COUNT)) %>%
arrange(desc(RETWEET))  %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
# read in lexicons
CroSentilex_n <- read.delim("C:/Users/Lukas/Dropbox/Mislav@Luka/crosentilex-negatives.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE,
fileEncoding = "UTF-8")  %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "NEG")
CroSentilex_p  <- read.delim("C:/Users/Lukas/Dropbox/Mislav@Luka/crosentilex-positives.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE,
fileEncoding = "UTF-8") %>%
rename(word = "V1", sentiment = "V2" ) %>%
mutate(brija = "POZ")
Crosentilex_sve <- rbind(setDT(CroSentilex_n), setDT(CroSentilex_p))
# check lexicon data
head(sample_n(Crosentilex_sve,1000),15)
CroSentilex_Gold  <- read.delim2("C:/Users/Lukas/Dropbox/Mislav@Luka/gs-sentiment-annotations.txt",
header = FALSE,
sep = " ",
stringsAsFactors = FALSE) %>%
rename(word = "V1", sentiment = "V2" )
Encoding(CroSentilex_Gold$word) <- "UTF-8"
CroSentilex_Gold[1,1] <- "dati"
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "-", "1")
CroSentilex_Gold$sentiment <- str_replace(CroSentilex_Gold$sentiment , "\\+", "2")
CroSentilex_Gold$sentiment <- as.numeric(unlist(CroSentilex_Gold$sentiment))
# check lexicon data
head(sample_n(CroSentilex_Gold,100),15)
# create stop words
stopwords_cro <- get_stopwords(language = "hr", source = "stopwords-iso")
# check stopwords data
head(sample_n(stopwords_cro,100),15)
# extend stop words
my_stop_words <- tibble(
word = c(
"jedan","mjera", "može", "možete", "mogu", "kad", "sada", "treba", "ima", "osoba",
"e","prvi", "dva","dvije","drugi",
"tri","treći","pet","kod",
"ove","ova",  "ovo","bez", "kod",
"evo","oko",  "om", "ek",
"mil","tko","šest", "sedam",
"osam",   "čim", "zbog",
"prema", "dok","zato", "koji",
"im", "čak","među", "tek",
"koliko", "tko","kod","poput",
"baš", "dakle", "osim", "svih",
"svoju", "odnosno", "gdje",
"kojoj", "ovi", "toga",
"ubera", "vozača", "hrvatskoj", "usluge", "godine", "više", "taksi", "taxi", "taksija", "taksija", "kaže", "rekao", "19"," aee", "ae","bit.ly", "https", "one", "the"
),
lexicon = "lux"
)
stop_corpus <- my_stop_words %>%
bind_rows(stopwords_cro)
# check stopwords data
head(sample_n(stop_corpus,100),15)
# read in data
forum <- as.data.table(forum)
forum[,.N, TITLE][order(-N)] %>% head(50)
forum[,.N, TITLE][order(-N)] %>%
slice(1:1000) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
forum[TITLE == "Zoran Milanović, predsjednik Republike Hrvatske vol. IV",] %>%
unnest_tokens(word,FULL_TEXT) -> ZM_token
# select forum
forum <- dt %>%
filter(SOURCE_TYPE == "forum")
# read in data
forum <- as.data.table(forum)
forum[TITLE == "Zoran Milanović, predsjednik Republike Hrvatske vol. IV",] %>%
unnest_tokens(word,FULL_TEXT) -> ZM_token
# remove stop words, numbers, single letters
ZM_token %>%
anti_join(stop_corpus, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) -> ZM_tokenTidy
# remove NA
ZM_tokenTidy %>%
filter(!is.na(word)) -> ZM_tokenTidy
ZM_tokenTidy[,.N,by = word][order(-N),]
## Vizualize most common words
ZM_tokenTidy[,.N,by = word][N>500][order(-N),][,word := reorder(word,N)] %>%
ggplot(aes(word, N)) +
geom_col() +
xlab(NULL) +
coord_flip() +
theme_economist()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(xlsx)
library(here)
library(kableExtra)
library(DT)
library(purrr)
library(data.table)
library(tidytext)
library(dplyr)
library(lubridate)
library(anytime)
library(grid)
library(wordcloud)
library(reshape2)
library(ggraph)
library(widyr)
library(topicmodels)
library(ggthemes)
# fullDta <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_NOTXT.csv")
# fullDtaTxt <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_TXT.csv")
dt <- fread("D:/LUKA/Freelance/Mediatoolkit/MktFULLtxt.csv")
dta <- dt %>%
filter(str_detect(AUTHOR,fixed("sponzor",ignore_case = TRUE)))
dta <- dt %>%
filter(str_detect(AUTHOR,fixed("tnative",ignore_case = TRUE)))
dta <- dt %>%
filter(str_detect(AUTHOR,fixed("24ContentHaus",ignore_case = TRUE)))
dta <- dt %>%
filter(str_detect(AUTHOR,fixed("Haus",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Haus",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Content",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,"sadržaj donosi",ignore_case = TRUE))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,"sadržaj donosi",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj donosi",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("nativ",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("24Content",ignore_case = TRUE)))24Content
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("24Content",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("24Content",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj donosi",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj nastao ",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen u produkciji",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("tnativ",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("nativ",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native tim",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("Native tim",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web") %>%
filter(str_detect(FULL_TEXT,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
View(dta)
knitr::opts_chunk$set(echo = TRUE)
# fullDta <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_NOTXT.csv")
# fullDtaTxt <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_TXT.csv")
dt <- fread("D:/LUKA/Freelance/Mediatoolkit/MktFULLtxt.csv")
library(tidyverse)
library(readxl)
library(xlsx)
library(here)
library(kableExtra)
library(DT)
library(purrr)
library(data.table)
library(tidytext)
library(dplyr)
library(lubridate)
library(anytime)
library(grid)
library(wordcloud)
library(reshape2)
library(ggraph)
library(widyr)
library(topicmodels)
library(ggthemes)
# fullDta <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_NOTXT.csv")
# fullDtaTxt <- fread("D:/LUKA/Freelance/Mediatoolkit/FULLDATA_TXT.csv")
dt <- fread("D:/LUKA/Freelance/Mediatoolkit/MktFULLtxt.csv")
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Content",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native tim",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("24Content",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("24ContentHaus",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj donosi",ignore_case = TRUE)))
View(dta)
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj nastao",ignore_case = TRUE)))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("tnative",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen u produkciji",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native",ignore_case = TRUE)))
View(dta)
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("tnative",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
View(dta)
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("24ContentHaus",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj donosi",ignore_case = TRUE)))
names(dta)
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj nastao",ignore_case = TRUE)))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("tnative",ignore_case = TRUE)))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen",ignore_case = TRUE)))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native",ignore_case = TRUE)))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
dta <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(xlsx)
library(here)
library(kableExtra)
library(DT)
library(purrr)
library(data.table)
library(tidytext)
library(dplyr)
library(lubridate)
library(anytime)
library(grid)
library(wordcloud)
library(reshape2)
library(ggraph)
library(widyr)
library(topicmodels)
library(ggthemes)
dta1 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("24ContentHaus",ignore_case = TRUE)))
dta2 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj donosi",ignore_case = TRUE)))
dta3 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("sadržaj nastao",ignore_case = TRUE)))
dta4 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("tnative",ignore_case = TRUE)))
dta5 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("prilog je napravljen",ignore_case = TRUE)))
dta6 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Native",ignore_case = TRUE)))
dta7 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(AUTHOR,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
dta8 <- dt %>%
filter(SOURCE_TYPE =="web")  %>%
filter(str_detect(FULL_TEXT,fixed("Sponzorirani sadržaj",ignore_case = TRUE)))
dta <- rbind(dta1, dta2,dta3,dta4,dta5, dta6, dta7,dta8)
activity <- dta %>%
group_by(FROM) %>%
summarise(count = n()) %>%
mutate(percent = round(count / sum(count) * 100,2)) %>%
arrange(desc(count))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
dta %>%
select(DATE,TIME,TITLE,FROM,AUTHOR,URL, FULL_TEXT) %>%
datatable(., options = list(scrollX = TRUE, scrollY = "500px"))
datatable(activity, options = list(scrollX = TRUE, scrollY = "500px"))
write.xlsx(dta, file = "D:/LUKA/Freelance/Mediatoolkit/native.xlsx", row.names = T)
